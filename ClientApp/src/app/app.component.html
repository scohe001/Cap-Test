
<!-- Toolbar -->
<mat-toolbar color="primary" class="header main-toolbar">
  <div [ngClass]="!responsiveManager.isSideNavOpened ? 'header-content-closed' : (responsiveManager.isSideNavExpanded ? 'header-content-expanded' : 'header-content-contracted')">
    <span class="header-nav-item nav-tool-items nav-tool-items-butt" (click)="toggleClicked()">
      <mat-icon>menu</mat-icon>
    </span>
  </div>
  <div class="header-options">
  <nav class="navbar navbar-expand-sm navbar-toggleable-sm header-navbar">
    <div class="container header-navbar-container">
      <div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse">
        <ul class="navbar-nav">
            <li class="nav-item header-nav-item" *ngIf="currentUser">
              <a  class="nav-link header-text" [routerLink]='["/authentication/profile"]' title="Manage">{{ currentUser.preferred_username }}</a>
            </li>
            <li class="nav-item header-nav-item">
                <a  class="nav-link header-text" [routerLink]='["/authentication/logout"]' [state]='{ local: true }' title="Logout" style="padding-right: 15px">Logout</a>
            </li>
        </ul>
      </div>
    </div>
  </nav>

  </div>
</mat-toolbar>

<!-- Sidenav -->
<mat-sidenav-container>
  <mat-sidenav
    #sidenav
    [mode]="isBiggerScreen() ? 'side' : 'push'"
    [(opened)]="responsiveManager.isSideNavOpened"
    [fixedInViewport]="true"
    class="main-sidenav"
    [@sideNavAnimation]="responsiveManager.isSideNavExpanded ? 'expanded' : 'contracted'"
    [fixedTopGap]="'0'"
    [fixedBottomGap]="'0'"
    >

    <mat-toolbar class="sidenav-header" routerLink="/">
      <span *ngIf="responsiveManager.isSideNavExpanded">Credit Cache</span>
      <span *ngIf="!responsiveManager.isSideNavExpanded">CC</span>
    </mat-toolbar>
    <mat-nav-list>

      <!--Nav Options-->
      <div *ngFor="let navOption of sideNavOptions">
        <a
          *ngIf="navOption.show()"
          mat-list-item
          [routerLink]="[navOption['link']]"
          (click)="closeSideNav()"
          [routerLinkActiveOptions]="{exact: false}"
          routerLinkActive
          #rla="routerLinkActive" 
          [ngClass]="rla.isActive && navOption['link'] !== '/' ? 'active-sidenav-item' : 'sidenav-item'">
          <!-- A little extra logic here^^^ so our test/examples won't seem active (since we have matching exact to false for register).
                Honestly a better way to do this may be to add a bool to "SideNavOption" for whether we want exact matching. That way
                we can configure this on an item by item basis and not need the wonky if.-->

          <mat-icon class="nav-icon"> {{navOption['icon']}} </mat-icon>
          <span *ngIf="responsiveManager.isSideNavExpanded"> {{navOption['name']}} </span>
        </a>
      </div>
    </mat-nav-list>
  </mat-sidenav>

  <!-- Main content -->
  <mat-sidenav-content [ngClass]="!responsiveManager.isSideNavOpened ? 'main-content-full' : responsiveManager.isSideNavExpanded ? 'main-content-expanded' : 'main-content-contracted'" class="main-content">

    <!-- Works, but not in sidenav for some reason :/ -->
    <!-- <div [@routeAnimations]="prepareRoute(outlet)" > -->
    <div class="router-content">
      <router-outlet #outlet="outlet"></router-outlet>
    </div>
    <!-- </div> -->

    <!-- This'll make sure the screen extends to the bottom -->
    <div class="space-taker"></div>

    <footer class="footer">
      <p class="footer-right"> Credit Cache {{versionNum}} </p>
    </footer>

  </mat-sidenav-content>

</mat-sidenav-container>

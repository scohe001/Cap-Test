<h1 id="tableLabel">Single Account View</h1>

<p *ngIf="!account"><em>Loading...</em></p>
<h2 *ngIf="account"> {{account.FirstName}} {{account.LastName}} <span *ngIf="account.PhoneNumber && account.PhoneNumber != null && account.PhoneNumber.length > 0">({{account.PhoneNumber}})</span></h2>

<!-- TODO: Now that we can get here from the TransactionRegister, back shouldn't always go to /accounts 
            Going to need to be clever here (maybe get passed something in the url?)
-->
<button mat-stroked-button color="primary" class="my-but" routerLink="/accounts">Back</button>

<button mat-stroked-button color="primary" class="my-but" (click)="thing()">Test!</button>

<button *ngIf="account" routerLink="/transaction-register/{{account.Id}}" mat-stroked-button color="primary" class="my-but">Make Transaction With This Account!</button><br><br>

<div
  matRipple
  [matRippleUnbounded]=true
  [matRippleRadius]="'10'"
  [matRippleColor]="'pink'">

  <!-- TODO: Reorganize these to look more like ATH. Maybe add some links? -->
  <mat-table [dataSource]="transactionTableSource" matSort class="mat-elevation-z8">

      <ng-container matColumnDef="Amount">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Amount </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.tran.Amount | currency}} </mat-cell>
      </ng-container>
    
      <ng-container matColumnDef="Type">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Type </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.tran.TransactionType.Name}} </mat-cell>
      </ng-container>
    
      <ng-container matColumnDef="Date">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Date </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.tran.Date | date:'shortDate'}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="Total">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Running Total </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.tran.NewTotal | currency}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="Detail">
        <mat-header-cell *matHeaderCellDef> Detail </mat-header-cell>
        <mat-cell *matCellDef="let element"> I cost {{element.tran.NewTotal | currency}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="Detail2">
        <mat-cell *matCellDef="let element"> Hi! I'm a second detail </mat-cell>
      </ng-container>

      <ng-container matColumnDef="Detail3">
        <mat-cell *matCellDef="let element"> Another? </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"
        class="my-row"
        [class.expanded]="expandedId === row.tran.Id"
        (click)="expandedId = (expandedId === row.tran.Id) ? null : row.tran.Id"></mat-row>

      <mat-row *matRowDef="let row; columns: ['Detail', 'Detail2', 'Detail3']; when: isExpansionDetailRow"
        [@detailExpand]="row.tran.Id === expandedId ? 'expanded' : 'collapsed'"
        style="overflow: hidden"
        class="detail-row"></mat-row>
  </mat-table>
</div>
